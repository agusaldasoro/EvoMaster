<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="create-brands-table" author="agusaldasoro">
        <comment>Create 'brands' table</comment>
        <createTable tableName="brands">
            <column name="id" type="bigserial"/>
            <column name="name" type="varchar(4000)"/>
            <column name="description" type="text"/>
            <column name="type" type="text"/>
            <column name="owner" type="text"/>
            <column name="creation_date" type="timestamp with time zone"/>
            <column name="last_updated_date" type="timestamp with time zone"/>
            <column name="is_deleted" type="boolean"/>
        </createTable>
    </changeSet>

    <changeSet id="add-not-null-constraints-brands-table" author="agusaldasoro">
        <comment>Add not null constraints to 'brands' table</comment>
        <addNotNullConstraint tableName="brands" columnName="id"/>
        <addNotNullConstraint tableName="brands" columnName="name"/>
        <addNotNullConstraint tableName="brands" columnName="creation_date"/>
        <addNotNullConstraint tableName="brands" columnName="last_updated_date"/>
        <addNotNullConstraint tableName="brands" columnName="is_deleted"/>
    </changeSet>

    <changeSet id="add-default-values-brands-table" author="agusaldasoro">
        <comment>Add default values to 'brands' table</comment>
        <addDefaultValue tableName="brands" columnName="is_deleted" defaultValueBoolean="false"/>
    </changeSet>

    <changeSet id="add-primary-key-brands-table" author="agusaldasoro">
        <comment>Add primary key to 'brands' table</comment>
        <addPrimaryKey tableName="brands" columnNames="id"/>
    </changeSet>

    <changeSet id="create-products-table" author="agusaldasoro">
        <comment>Create 'products' table</comment>
        <createTable tableName="products">
            <column name="brand_id" type="bigserial"/>
            <column name="name" type="text"/>
            <column name="creation_date" type="timestamp with time zone"/>
            <column name="last_updated_date" type="timestamp with time zone"/>
            <column name="is_deleted" type="boolean"/>
        </createTable>
    </changeSet>

    <changeSet id="add-not-null-constraints-products-table" author="agusaldasoro">
        <comment>Add not null constraints to 'products' table</comment>
        <addNotNullConstraint tableName="products" columnName="brand_id"/>
        <addNotNullConstraint tableName="products" columnName="name"/>
        <addNotNullConstraint tableName="products" columnName="creation_date"/>
        <addNotNullConstraint tableName="products" columnName="last_updated_date"/>
        <addNotNullConstraint tableName="products" columnName="is_deleted"/>
    </changeSet>

    <changeSet id="add-default-values-products-table" author="agusaldasoro">
        <comment>Add default values to 'products' table</comment>
        <addDefaultValue tableName="products" columnName="is_deleted" defaultValueBoolean="false"/>
    </changeSet>

    <changeSet id="add-primary-key-products-table" author="agusaldasoro">
        <comment>Add primary key to 'products' table</comment>
        <addPrimaryKey tableName="products" columnNames="brand_id, name"/>
    </changeSet>

    <changeSet id="add-foreign-key-constraints-products-table" author="agusaldasoro">
        <comment>Add foreign key to 'products' table</comment>
        <addForeignKeyConstraint baseTableName="products" baseColumnNames="brand_id"
                                 referencedTableName="brands" referencedColumnNames="id"
                                 constraintName="fk_products_brands"/>
    </changeSet>

</databaseChangeLog>
